const bodyWrapper=document.querySelector("#body-wrapper"),siteHeader=document.querySelector(".site-header"),mobileBtn=document.querySelector("#menu-mobile"),closeBtn=document.querySelector("#close-btn"),backBtn=document.querySelector("#back-btn"),navWrapper=document.querySelector("#nav-wrapper"),parentMenuItems=document.querySelectorAll(".main-menu .menu-item-has-children"),searchBtn=document.querySelector("#search-btn"),closeOverlay=document.querySelector("#overlay-close"),searchOverlay=document.querySelector("#search-overlay"),coverSlider=document.querySelector(".cover-slider"),coverSlides=document.querySelectorAll(".cover-slider .slide"),portfolioCategories=document.querySelectorAll(".page-template-template-portfolio .portfolio__categories .category"),projects=document.querySelectorAll(".page-template-template-portfolio .project"),galleryBtns=document.querySelectorAll(".page-template-template-portfolio .open-gallery"),galleryOverlay=document.querySelector("#gallery-slideshow"),sections=document.querySelectorAll("body section");function eventListeners(){window.screen.width<1023&&(mobileBtn.addEventListener("click",showMenu),parentMenuItems.forEach(e=>{e.addEventListener("click",t=>{t.target===e&&showSubmenu(t)})}),closeBtn.addEventListener("click",hideMenu),backBtn.addEventListener("click",hideSubMenu)),searchBtn.addEventListener("click",showSearch),closeOverlay.addEventListener("click",closeSearch),window.addEventListener("resize",coverPositioning),0!=coverSlides.length&&coverSlides.forEach(e=>{e.addEventListener("click",t=>turnVisible(t,e))}),portfolioCategories&&portfolioCategories.forEach(e=>{e.addEventListener("click",t=>filterCategories(t,e))}),galleryBtns&&galleryBtns.forEach(e=>{e.addEventListener("click",e=>showGallery(e))}),document.body.addEventListener("click",e=>{(e.target.classList.contains("gallery-overlay-close")||e.target.parentElement.classList.contains("gallery-overlay-close"))&&closeGallery()}),window.addEventListener("scroll",isVisibleInViewport)}function showMenu(){mobileBtn.classList.add("open"),navWrapper.classList.add("open")}function showSubmenu(e){e.currentTarget.children[1].classList.add("open"),backBtn.style.display="flex"}function hideMenu(){document.querySelectorAll(".main-menu .sub-menu.open, #nav-wrapper.open, #menu-mobile.open").forEach(e=>{e.classList.remove("open")})}function hideSubMenu(){let e=document.querySelectorAll(".main-menu .sub-menu.open"),t=e.length;t>0&&e[t-1].classList.remove("open"),1==t&&(backBtn.style.display="none")}function showSearch(){searchOverlay.classList.add("open"),closeOverlay.classList.add("open")}function closeSearch(){searchOverlay.classList.remove("open"),closeOverlay.classList.remove("open")}function coverPositioning(){coverSlider.style.marginTop=siteHeader.clientHeight+"px",coverSlider.style.height=window.innerHeight-siteHeader.clientHeight+"px"}function initSlider(){document.querySelector(".cover-slider .slide[data-id='slide-0']").classList.add("visible"),document.querySelector(".cover-slider .slide[data-id='slide-0'] .content").classList.add("visible")}function turnVisible(e,t){if(t.children[1]==e.target){let e=t.getAttribute("data-id").split("-"),l=Number(e[1])+1;t.classList.remove("visible"),t.querySelector(".content").classList.remove("visible"),l!==coverSlides.length?(coverSlides[l].classList.add("visible"),coverSlides[l].querySelector(".content").classList.add("visible")):(coverSlides[0].classList.add("visible"),coverSlides[0].querySelector(".content").classList.add("visible"))}}function autoplay(){let e=document.querySelector(".cover-slider .slide.visible"),t=e.getAttribute("data-id").split("-"),l=Number(t[1])+1;e.classList.remove("visible"),e.querySelector(".content").classList.remove("visible"),l!==coverSlides.length?(coverSlides[l].classList.add("visible"),coverSlides[l].querySelector(".content").classList.add("visible")):(coverSlides[0].classList.add("visible"),coverSlides[0].querySelector(".content").classList.add("visible"))}function filterCategories(e,t){let l=t.getAttribute("data-cat");portfolioCategories.forEach(e=>{e.classList.remove("selected")}),t.classList.add("selected"),projects.forEach(e=>{if(e.classList.remove("visible"),"0"==l)e.style.display="flex",setTimeout(()=>{e.classList.add("visible")},400);else{e.getAttribute("data-cat").split("-").includes(l)&&(e.style.display="flex",setTimeout(()=>{e.classList.add("visible")},300))}}),setTimeout(()=>{document.querySelectorAll(".page-template-template-portfolio .project:not(.visible)").forEach(e=>{e.style.display="none"})},400)}function showGallery(e){e.preventDefault();let t=e.target.getAttribute("data-photosids").split("-"),l=document.querySelector("#gallery-overlay");if((l?l.getAttribute("data-ids"):"")!==e.target.getAttribute("data-photosids")){l&&l.remove();let i=galleryOverlay.content.cloneNode(!0);bodyWrapper.appendChild(i),document.querySelector("#gallery-overlay").setAttribute("data-ids",e.target.getAttribute("data-photosids")),t.forEach((async function(e,l=0){let i=await fetchWPAPI(e),o=document.createElement("IMG");o.setAttribute("id","photo-slide-"+l),o.setAttribute("src",i.guid.rendered),o.setAttribute("style","opacity: 0"),document.querySelector("#gallery-overlay .gallery-slide__inner").appendChild(o);let r=document.createElement("A");r.setAttribute("href","#photo-slide-"+l);let s=document.createElement("IMG");s.setAttribute("src",i.media_details.sizes.thumbnail.source_url),r.setAttribute("style","opacity: 0"),r.appendChild(s),document.querySelector("#gallery-overlay .gallery-selector__inner").appendChild(r),stylingEvent(++l,t.length)}))}else l.style.display="flex"}async function fetchWPAPI(e){let t=await fetch(document.location.origin+"/wp-json/wp/v2/media/"+e);return await t.json()}function stylingEvent(e,t){let l=document.querySelector("#gallery-overlay .gallery-slide__inner");if(t%2!=0)l.scrollTop=(l.scrollHeight-l.clientHeight)/2;else{let e=(t/2-1)*(.8*l.clientHeight+37.5);l.scrollTop=e}t===e?setTimeout(()=>{document.querySelector("#gallery-overlay .spinner").style.display="none";let e=document.querySelectorAll("#gallery-overlay .gallery-slide__inner img"),t=document.querySelectorAll("#gallery-overlay .gallery-selector__inner a");e.forEach((function(e,l=0){e.style.opacity="1",t[l].style.opacity="1",l++}))},500):document.querySelector("#gallery-overlay .spinner").style.display="block"}function closeGallery(){document.querySelector("#gallery-overlay").style.display="none"}function initSections(){sections.forEach(e=>{e.classList.contains("cover-slider")||e.setAttribute("data-visibility","hidden")})}function isVisibleInViewport(){sections.forEach(e=>{let t=e.getBoundingClientRect();t.top>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.setAttribute("data-visibility","visible")})}initSections(),document.addEventListener("DOMContentLoaded",()=>{eventListeners(),coverPositioning(),0!=coverSlides.length&&initSlider(),coverSlider.classList.contains("autoplay")&&setInterval(autoplay,6e3)});